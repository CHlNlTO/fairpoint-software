                                  AMEWQEQ} ifLAIMS -- HLEAW

    1. A data backup method, wherein the method is applied to a data backup system, the data

    backup system comprises a primary cluster, a secondary cluster, and a control device, and the

    method comprises:

    controlling, by the control device based on a first data backup policy, the primary cluster or

    the secondary cluster to back up, to the secondary cluster, a plurality of data sets related to a first

    service that are in the primary cluster and that are at a first moment, wherein the first data backup

    policy comprises information about the plurality of data sets related to the first service and the first

    moment.

10  2. The method according to claim 1, wherein the controlling, by the control device based on

    a first data backup policy, the primary cluster or the secondary cluster to back up, to the secondary

    cluster, a plurality of data sets related to a first service that are in the primary cluster and that are

    at a first moment comprises:

    sending, by the control device, a first instruction to the primary cluster, to instruct the primary

15 cluster to send, to the secondary cluster, data corresponding to snapshots of the plurality of data

    sets related to the first service that are at the first moment, or

    sending, by the control device, a second instruction to the secondary cluster, to instruct the

    secondary cluster to replicate, from the primary cluster, data corresponding to snapshots of the

    plurality of data sets related to the first service that are at the first moment and that are in the

2O primary cluster.

    3. The method according to claim 2, wherein before the sending, by the control device, a first

    instruction to the primary cluster, or the sending, by the control device, a second instruction to the

    secondary cluster, the method further comprises:

    sending, by the control device, a third instruction to the primary cluster, wherein the third

25 instruction comprises the information about the plurality of data sets related to the first service and

    the first moment, and the third instruction instructs the primary cluster to obtain the snapshots of

    the plurality of data sets related to the first service that are at the first moment.

    4. The method according to any one of claims 1 to 3, wherein the method further comprises:

    sending, by the control device, a fourth instruction to the primary cluster, wherein the fourth

3O instruction instructs the primary cluster to synchronize user data to the secondary cluster, or

    obtaining, by the control device, user data stored in the primary cluster and the secondary

    cluster, and adjusting, by the control device based on the user data stored in the primary cluster,

    the user data stored in the secondary cluster.
         5. The method according to any one of claims 1 to 4, wherein the method further comprises:

         configuring, by the control device, the first data backup policy for the first service based on

    the information that is about the plurality of data sets related to the first service and that is entered

    by a user and the first moment.

         6. The method according to any one of claims 1 to 5, wherein the method further comprises:

         configuring, by the control device, a second data backup policy for a second service, wherein

    the second data backup policy comprises information about a plurality of data sets related to the

    second service and a second moment, and

         controlling, by the control device based on the second data backup policy, the primary cluster

10 or the secondary cluster to back up, to the secondary cluster, the plurality of data sets related to the

    second service that are in the primary cluster and that are at the second moment.

         7. The method according to any one of claims 1 to 6, wherein the plurality of data sets related

    to the first service comprise a data set processed or stored by a first component in the primary

    cluster and a data set processed or stored by a second component in the primary cluster.

15       8. The method according to any one of claims 1 to 7, wherein the control device comprises a

    primary client and a secondary client, the primary client is configured to detect first status

    information of the primary cluster, the secondary client is configured to detect second status

    information of the secondary cluster, and the method further comprises:

         obtaining, by the control device, the first status information obtained through detection of the

20 primary client and the second status information obtained through detection of the secondary client,

    and

         when the first status information indicates that the primary cluster is a secondary identity or

    the cluster fails, and the second status information indicates that the secondary cluster is a primary

    identity, determining, by the control device, that the secondary client is a client accessed by an

25 application.

         9. The method according to claim 8, wherein the method further comprises:

         prompting, by the control device, the user with information indicating that the primary cluster

    is faulty, and

         adjusting, by the control device, an identity of the secondary cluster from the secondary

3O identity to the primary identity in response to an identity adjustment operation of the user for the

    secondary cluster.

         10. The method according to any one of claims 1 to 9, wherein the control device is deployed

    in an isolated manner from the primary cluster.

         11. The method according to any one of claims 1 to 10, wherein a same clock source is set in

35 the control device, the primary cluster, and the secondary cluster.

                                                     2
    12. The method according to any one of claims 1 to 11, wherein the primary cluster and/or

    the secondary cluster comprise/comprises a cluster constructed based on a hadoop architecture.

    13. A data backup method, wherein the method is applied to a data backup system, the data

    backup system comprises a primary cluster, a secondary cluster, and a control device, and the

    method comprises:

    obtaining, by the primary cluster, an instruction delivered by the control device, wherein the

    instruction comprises information about a plurality of data sets related to a first service and a first

    moment, and

    backing up, by the primary cluster to the secondary cluster based on the instruction, the

10 plurality of data sets related to the first service that are in the primary cluster and that are at the

    first moment.

    14. The method according to claim 13, wherein the backing up, by the primary cluster to the

    secondary cluster based on the instruction, the plurality of data sets related to the first service that

    are in the primary cluster and that are at the first moment specifically comprises:

15  obtaining, by the primary cluster based on the information about the plurality of data sets

    related to the first service and the first moment, snapshots of the plurality of data sets related to

    the first service that are in the primary cluster and that are at the first moment, and

    sending, by the primary cluster, data corresponding to the snapshots to the secondary cluster

    based on the snapshots.

2O  15. The method according to claim 13 or 14, wherein the method further comprises:

    synchronizing, by the primary cluster, user data to the secondary cluster.

    16. The method according to any one of claims 13 to 15, wherein the primary cluster and/or

    the secondary cluster comprise/comprises a cluster constructed based on a hadoop architecture.

    17. A data backup system, wherein the data backup system comprises a control device, a

25 primary cluster, and a secondary cluster, wherein

    the control device is configured to perform the method according to any one of the method

    claims 1 to 12,

    the primary cluster is configured to perform the method according to any one of the method

    claims 13 to 16, and

3O  the secondary cluster is configured to obtain and store a data set backed up from the primary

    cluster.

    18. A control device, wherein the computing device comprises a processor and a memory,

    wherein

    the processor is configured to execute instructions stored in the memory, to enable the

35 computing device to perform the method according to any one of claims 1 to 12.

                             3
