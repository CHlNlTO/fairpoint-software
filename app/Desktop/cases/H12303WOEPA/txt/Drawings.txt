             1/10
             141
              1001\®/ 122

       1001          1011 1012

131

                           x.        111

             1011    %

             FIG. 1
             122

                     1044      1042
                               1043
                      K
                     x.

             FIG. 2

             87
Service forwarding             2/10
     apparatus
                                           Memory 1 102
 Processor 1 101
                                                Program
                                     77777777777777777777777777777777777777777

                                         Forwarding entry

                                      ID of a service function
                                                apparatus

  0                                Communlcatlons

Communications                          bus 1 104

 interface 1 103

    4

    0

                               FIG. 3

comumnuinF1tlr1_cs1at0t5l.ons  Firustn1o. tb1ta1i0n7ing  First sending unit
                                                                1106

Second obtaining               Third obtaining           First determining
    unit 1108                     unit 1109                  unit 1110

Service forwarding                                       Second sending
      apparatus                                               unit 1 1 1 1

                     FIG. 4

                               88
                          3/10

Device for initiating               Memory 1302
    fault detectlon                     Program

   Processor                      Forwarding entry
      1301

Communications                  Communications

 interface 1303                    bus 1304

                       v

                          FIG. 5

Third receiving           First determining  First adding unit
   unit 1312                  unit 1313             1307

Device for inifiating     First receiving    Sending unit

    fault detectlon          unit 1 30 5           1 306

                          FIG. 6

                          89
                       4/10

Service function               Memory 1202
    apparatus
                               Program
   Processor
      1201                    Forwarding entry

                       _,,,::::::::::::::::::::::::::::::::;",1

                          ID of a service function

                       1       apparatus            3

< ii                          Communications
                   __             bus 1204
      Communlcatlons
       interface 1203

                       FIG. 7

Receiving unit                 Sending unit
      1205                          1206

  First parameter              Service fimction
updating unit 1207                 apparatus

                       FIG. 8

                          90
/ 131                                 5/10                           / / 121               122

                                 / 111

 Service                         SFE                                 node  node
classifier

            501. Send a fault
            tracing detection H7 502. Send the fault tracing
                                      detection request packet 1042
            request packet 1042

                                         503. Send a fault tracing
                                      detection request packet 1042 7

            504. Obtain an ID of an SF node
             121 and a first TTL parameter

     505. When the first TTL
        parameter reaches a

e preset value, send a fault
          tracing detection

       response packet 1032

            506. Send a fault
            tracing detection a 507. Send the fault tracing
            request packet 1043
                                 7 detection request packet 1043

                                       508. Send a fault tracing
                                 ` detection request packet 1043 7

                   509. Obtain the ID of an SF node
                     121 and a second TTL parameter

                                            510. When the second TTL parameter
                                            does not reach the preset value, send a >
                                              fault tracing detection request packet 1044

                                                511. Send a fault tracing detection
                                                              request packet 1044

                   512. Obtain an ID of an SF node
                     122 and a third TTL parameter

     513. When the third TTL
       parameter reaches the

e preset value, send a fault
          tracing detection

       response packet 1034

                                      FIG. 9

                                      91
                        6/10

                                                       122                                        123

                        1023 1024                              1025 1026
                                                                                1 12

                                                       121

                        FIG. 10

       First             Control unit                            Second                              Third 1
communications               1 120                             determining                        sending unit 1
                                                                unit1114
    unit1105                Fourth                                                                    1115 `
                        obtaining unit
 First obtaining
    unit 1107                1113

                        Fifth obtaining ______ Receiving

                        ` unit1117                             unit1116

Fl.urnslt.ts1e1n0d.6mg  Fuirpsdt apta. mrgamuentle.tr  ------  uppdaSareatc-mmoegntduenrl-t  :::  foSrewravricd_leng
                              1 1 18                                1 1 19                         apparatus

                        FIG. 1 1

                              92
                                                        7/10

                             Second receiving                 Sec1omn". d1a3d0d8ing  Thmirm_d a1d3d0i9ng
                                 unit 131 1

` Thiurnditre1c3e1i2ving """" Firstundiette1r3m1i3ning

Device for initiating  First receiving                        Sending unit           Fourth adding
   fault detection       unit 1305                                1306                 unit 13 10 1

                       FIG. 12

Receiving unit                                          Sending unit  Service fimction
      1205                                                   1206         apparatus

Second parameter                                         Third parameter
updating unit 1208                                      updating unit 1209

                       FIG. 13

                                                        93
                                   8/10

131                     111                       121    122 112                     123

Service            SFE                            SF SF                           SF
classifier                                 node node SFE                         DOdC

301. Send a fault       302, Send the

7 tracing detection + fault tracing

request packet 1021 * detection request a

                        packet 1 02 1

                       303. Send a fault
                   * tracing detection ,

                     request packet 1022

    304. Obtain an ID of an SF node 121 and a
    fault tracing detection response packet 1032

    305. Send the fault
¢ tracing detection

   response packet 1032

               306. Obtain a fault tracing
             detection request packet 1023

                       307. Send the fault tracing ,
                     detection request packet 1023

                         308. Send a fault tracing
                   ` detection request packet 1024 7

     309. Obtain an ID of an SF node 122 and a
    fault tracing detection response packet 1034

    310. Send the fault
4 tracing detection

  response packet 1034

31 1. Obtain a fault tracing detection request packet 1025

                   P    312. Send the faulttracing       a,  313. Send the fault     *
                                                              tracing detection
                        detection request packet 1025
                                                             request packet 1025

                                                                  314. Send a fault
                                                            `7 tracing detection

                                                                request packet 1026

      316. Send the fault tracing  315. Obtain an ID of an SF node 123 and a
` detection response packet 1036   fault tracing detection response packet 1036

                                   FIG. 14

                                       94
       9/10         W 123
     m 122

     10511051       10511051

131  R         111  R

     x.             x.        112
     1051 %    1051 %

     10511051

     @ 121

     FIG. 15

     95
                                10/10

     / 131               / 111  / 121          / / 122 112                      / 123
                       SFE
Service                          SF            SF                                SF
classifier                      node          node SFE                          node

   701' 56m? a         702. Send the
   connect1V1ty        connectivity
  padcekteetct1l0o5n1  padcekteetct1i0o5n1 '

`                            703. Send a
                            connectivity
                       « detection
                            packet 105 1

                          704. Send a connectivity
                           detection packet 1051 *

                           705. Send a connectivity
                             detection packet 1051

                                706. Send a connectivity       70%7finiifiifge
                                 detectlon packet 1051    ' 7 detection

                                                             packet 105 1

                          709. Feed back a connectivity   7  708. Send a
                       ;        detection result             connectjvity

                                                              detectlon
                                                             packet 1051

                                FIG. 16

Network encapsulation Service chain header                   Content

                                Flag          Path ID     type ID of a node

                                FIG. 17

                                      96
